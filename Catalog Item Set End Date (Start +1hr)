function onChange(control, oldValue, newValue, isLoading) {
	if (isLoading || newValue == '') {
		return;
	}
	
	
	var startDate = g_form.getValue('start_date_time'); //Choose the field to add time from
	var addtime = 1; //The amount of time to add
	var addtype = 'hour'; //The time type.   Can be second, minute, hour, day, week, month, year.
	
	// If check prevents recursion of the change of the start_date_time field.
	if(!/(\d\d\:\d\d\:)(00)( [AP]M)/.test(startDate)) {
		startDate = startDate.replace(/(\d\d\:\d\d\:)(\d\d)( [AP]M)/,"$100$3");
		g_form.setValue('start_date_time', startDate);
		// Return from the function if the seconds are already 00
		return;
	}
	
	// get an hour later for end date
	var ajax = new GlideAjax('global.ClientDateTimeUtils');
	ajax.addParam('sysparm_name', 'addDateTimeAmount');
	ajax.addParam('sysparm_fdt', startDate);
	ajax.addParam('sysparm_addtime', addtime);
	ajax.addParam('sysparm_addtype', addtype);
	ajax.getXMLAnswer(function(answer){
		g_form.setValue('end_date_time', answer);
		
		if (typeof(Storage) !== "undefined") {
			localStorage.setItem("ReminderEndDate", answer);
		} else {
			console.error("Sorry! No Web Storage support..");
		}
	});
	
	/*
	g_form.clearMessages();
	
	var fdt = g_form.getValue('start_date_time'); //First Date/Time field
	var dttype = 'hour'; //this can be day, hour, minute, second. By default it will return seconds.

	var hoursFromNow = new GlideAjax('global.ClientDateTimeUtils');
	hoursFromNow.addParam('sysparm_name','getNowDateTimeDiff');
	hoursFromNow.addParam('sysparm_fdt', fdt);
	hoursFromNow.addParam('sysparm_difftype', dttype);
	hoursFromNow.getXMLAnswer(function(answer) {
		var hours = Math.round(JSON.parse(answer));
		if (hours < 48) {
			// TODO: Message appears twice on first trigger. All subsequent triggers only show a single info message.
			g_form.addInfoMessage("Your visit is less than 48 hours away! Please have your guests complete their NDAs right away by completing this form " + buildLink('com.glideapp.servicecatalog_cat_item_view.do?v=1&sysparm_id=3a6abe464f1376008418b485f110c742&sysparm_link_parent=dea6a5d14ff0cb005d839ffd0210c770&sysparm_catalog=e0d08b13c3330100c8b837659bba8fb4&sysparm_catalog_view=catalog_default&sysparm_view=text_search', 'Send DocuSign NDA', false));
			
			// Scroll to the top to ensure they see the message
			window.scroll(0,0);
		}
		
	});
	*/
	
}

function buildLink(url, text, mailTo) {
	if (mailTo) {
		return "<a href=mailto:" + url + ">" + text + "</a>";
	} else {
		var newWindow = "target='_blank'";
		return "<a href='" + url + "'" + newWindow + ">" + text + "</a>";
	}
}

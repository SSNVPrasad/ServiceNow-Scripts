var log = 'calc. old durations';
var query = '';
query += 'calendar_durationISEMPTY^';
query += 'opened_atISNOTEMPTY^';
query += 'closed_atISNOTEMPTY^';
query += 'sys_class_name!=incident^';
query += 'sys_class_name!=problem^';

var task = new GlideRecord('task');
task.addEncodedQuery(query);
task.query();
var x = 0;
while(task.next()){
    x++;
    if(x%1000 === 0){
        gs.log('x: ' + x + ' of ' + task.getRowCount(), log);
    }
    var opened = task.opened_at.getDisplayValue();
    var closed = task.closed_at.getDisplayValue();
    task.business_duration = gs.calDateDiff(opened, closed, false);
    task.calendar_duration = gs.dateDiff(opened, closed, false);
    task.setWorkflow(false);
    task.autoSysFields(false);
    task.update();
}
